Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:57<00:57, 57.62s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:15<00:00, 34.21s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:15<00:00, 37.72s/it]
/cbica/home/xjia/.conda/envs/textlearning/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:389: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`. This was detected when initializing the generation config instance, which means the corresponding file may hold incorrect parameterization and should be fixed.
  warnings.warn(
/cbica/home/xjia/.conda/envs/textlearning/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:394: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`. This was detected when initializing the generation config instance, which means the corresponding file may hold incorrect parameterization and should be fixed.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:33<00:33, 33.10s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:44<00:00, 20.54s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:44<00:00, 22.43s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:33<00:33, 33.77s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:47<00:00, 21.74s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:47<00:00, 23.54s/it]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:23<00:23, 23.73s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:34<00:00, 16.21s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:34<00:00, 17.34s/it]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:41<00:41, 41.11s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:56<00:00, 26.22s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:56<00:00, 28.46s/it]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:32<00:32, 32.07s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:44<00:00, 20.36s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:44<00:00, 22.12s/it]
Loading checkpoint shards:   0%|          | 0/8 [00:00<?, ?it/s]Loading checkpoint shards:  12%|█▎        | 1/8 [00:04<00:28,  4.06s/it]Loading checkpoint shards:  25%|██▌       | 2/8 [00:08<00:24,  4.15s/it]Loading checkpoint shards:  38%|███▊      | 3/8 [00:12<00:20,  4.15s/it]Loading checkpoint shards:  50%|█████     | 4/8 [00:16<00:16,  4.15s/it]Loading checkpoint shards:  62%|██████▎   | 5/8 [00:20<00:12,  4.10s/it]Loading checkpoint shards:  75%|███████▌  | 6/8 [00:24<00:08,  4.13s/it]Loading checkpoint shards:  88%|████████▊ | 7/8 [00:28<00:04,  4.13s/it]Loading checkpoint shards: 100%|██████████| 8/8 [00:30<00:00,  3.33s/it]Loading checkpoint shards: 100%|██████████| 8/8 [00:30<00:00,  3.82s/it]
Loading checkpoint shards:   0%|          | 0/8 [00:00<?, ?it/s]Loading checkpoint shards:  12%|█▎        | 1/8 [00:01<00:10,  1.48s/it]Loading checkpoint shards:  25%|██▌       | 2/8 [00:03<00:09,  1.53s/it]Loading checkpoint shards:  38%|███▊      | 3/8 [00:04<00:07,  1.55s/it]Loading checkpoint shards:  50%|█████     | 4/8 [00:06<00:06,  1.55s/it]Loading checkpoint shards:  62%|██████▎   | 5/8 [00:07<00:04,  1.56s/it]Loading checkpoint shards:  75%|███████▌  | 6/8 [00:09<00:03,  1.55s/it]Loading checkpoint shards:  88%|████████▊ | 7/8 [00:10<00:01,  1.55s/it]Loading checkpoint shards: 100%|██████████| 8/8 [00:11<00:00,  1.27s/it]Loading checkpoint shards: 100%|██████████| 8/8 [00:11<00:00,  1.44s/it]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:48<00:48, 48.77s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:07<00:00, 31.32s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:07<00:00, 33.94s/it]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:39<00:39, 39.37s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:51<00:00, 23.40s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:51<00:00, 25.80s/it]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:43<00:43, 43.16s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:00<00:00, 27.85s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:00<00:00, 30.15s/it]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:39<00:39, 39.20s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:53<00:00, 24.31s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:53<00:00, 26.54s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:33<00:33, 33.39s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:50<00:00, 23.64s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:50<00:00, 25.11s/it]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:28<00:28, 28.96s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:42<00:00, 20.05s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:42<00:00, 21.39s/it]
Loading checkpoint shards:   0%|          | 0/8 [00:00<?, ?it/s]Loading checkpoint shards:  12%|█▎        | 1/8 [00:01<00:10,  1.51s/it]Loading checkpoint shards:  25%|██▌       | 2/8 [00:07<00:23,  3.98s/it]Loading checkpoint shards:  38%|███▊      | 3/8 [00:08<00:14,  2.93s/it]Loading checkpoint shards:  50%|█████     | 4/8 [00:10<00:09,  2.41s/it]Loading checkpoint shards:  62%|██████▎   | 5/8 [00:12<00:06,  2.12s/it]Loading checkpoint shards:  75%|███████▌  | 6/8 [00:13<00:03,  1.93s/it]Loading checkpoint shards:  88%|████████▊ | 7/8 [00:15<00:01,  1.83s/it]Loading checkpoint shards: 100%|██████████| 8/8 [00:16<00:00,  1.47s/it]Loading checkpoint shards: 100%|██████████| 8/8 [00:16<00:00,  2.00s/it]
Loading checkpoint shards:   0%|          | 0/8 [00:00<?, ?it/s]Loading checkpoint shards:  12%|█▎        | 1/8 [00:01<00:11,  1.58s/it]Loading checkpoint shards:  25%|██▌       | 2/8 [00:03<00:09,  1.58s/it]Loading checkpoint shards:  38%|███▊      | 3/8 [00:04<00:07,  1.57s/it]Loading checkpoint shards:  50%|█████     | 4/8 [00:06<00:06,  1.54s/it]Loading checkpoint shards:  62%|██████▎   | 5/8 [00:07<00:04,  1.54s/it]Loading checkpoint shards:  75%|███████▌  | 6/8 [00:09<00:03,  1.53s/it]Loading checkpoint shards:  88%|████████▊ | 7/8 [00:10<00:01,  1.53s/it]Loading checkpoint shards: 100%|██████████| 8/8 [00:11<00:00,  1.24s/it]Loading checkpoint shards: 100%|██████████| 8/8 [00:11<00:00,  1.43s/it]
Loading checkpoint shards:   0%|          | 0/19 [00:00<?, ?it/s]Loading checkpoint shards:   5%|▌         | 1/19 [00:14<04:14, 14.13s/it]Loading checkpoint shards:  11%|█         | 2/19 [00:27<03:49, 13.53s/it]Loading checkpoint shards:  16%|█▌        | 3/19 [00:41<03:44, 14.03s/it]Loading checkpoint shards:  21%|██        | 4/19 [00:58<03:45, 15.04s/it]Loading checkpoint shards:  26%|██▋       | 5/19 [01:14<03:37, 15.56s/it]Loading checkpoint shards:  32%|███▏      | 6/19 [01:29<03:17, 15.22s/it]Loading checkpoint shards:  37%|███▋      | 7/19 [01:43<02:58, 14.88s/it]Loading checkpoint shards:  42%|████▏     | 8/19 [01:57<02:39, 14.46s/it]Loading checkpoint shards:  47%|████▋     | 9/19 [02:09<02:18, 13.89s/it]Loading checkpoint shards:  53%|█████▎    | 10/19 [02:34<02:34, 17.22s/it]Loading checkpoint shards:  58%|█████▊    | 11/19 [02:51<02:16, 17.08s/it]Loading checkpoint shards:  63%|██████▎   | 12/19 [03:04<01:52, 16.03s/it]Loading checkpoint shards:  63%|██████▎   | 12/19 [03:06<01:48, 15.55s/it]
Traceback (most recent call last):
  File "/gpfs/fs001/cbica/home/xjia/qlora/examples/qlora_models_mc_generate.py", line 167, in <module>
    base_model = AutoModelForCausalLM.from_pretrained(
  File "/cbica/home/xjia/.conda/envs/textlearning/lib/python3.9/site-packages/transformers/models/auto/auto_factory.py", line 566, in from_pretrained
    return model_class.from_pretrained(
  File "/cbica/home/xjia/.conda/envs/textlearning/lib/python3.9/site-packages/transformers/modeling_utils.py", line 3706, in from_pretrained
    ) = cls._load_pretrained_model(
  File "/cbica/home/xjia/.conda/envs/textlearning/lib/python3.9/site-packages/transformers/modeling_utils.py", line 4091, in _load_pretrained_model
    state_dict = load_state_dict(shard_file)
  File "/cbica/home/xjia/.conda/envs/textlearning/lib/python3.9/site-packages/transformers/modeling_utils.py", line 503, in load_state_dict
    with safe_open(checkpoint_file, framework="pt") as f:
RuntimeError: unable to mmap 4983004072 bytes from file </cbica/home/xjia/.cache/huggingface/hub/models--mistralai--Mixtral-8x7B-v0.1/snapshots/58301445dc1378584211722b7ebf8743ec4e192b/model-00013-of-00019.safetensors>: Cannot allocate memory (12)
